<!doctype html>
<html>

<head>
    <meta charset="utf-8" />
    <title>Contract Agent Subscription (Demo)</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 40px;
            max-width: 720px;
        }

        button {
            padding: 12px 16px;
            margin: 8px 0;
            width: 260px;
            font-size: 16px;
            cursor: pointer;
        }

        .note {
            color: #444;
            margin-top: 18px;
            line-height: 1.5;
        }

        a {
            color: #0067b8;
        }

        code {
            background: #f4f4f4;
            padding: 2px 6px;
            border-radius: 4px;
        }
    </style>
</head>

<body>
    <h1>Activate your subscription (Demo)</h1>
    <p>Select a plan to activate it for your organisation (no payment in demo).</p>

    <button onclick="activate('Bronze')">Activate Bronze</button><br />
    <button onclick="activate('Silver')">Activate Silver</button><br />
    <button onclick="activate('Gold')">Activate Gold</button><br />


<hr style="margin: 24px 0;" />

<h2 style="margin-bottom: 8px;">What you get</h2>
<p style="margin-top: 0; color: #555;">
    Simple demo tiers (no payment). Pick the tier that matches the depth you need.
</p>

<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(240px, 1fr)); gap: 12px; margin-top: 12px;">
    <div style="border: 1px solid #e5e5e5; border-radius: 10px; padding: 14px;">
        <h3 style="margin: 0 0 8px;">Bronze</h3>
        <ul style="margin: 0; padding-left: 18px;">
            <li><strong>Quick review only</strong> (top risks)</li>
            <li>General Counsel lens only</li>
            <li>No precedent bank signals</li>
        </ul>
    </div>

    <div style="border: 1px solid #e5e5e5; border-radius: 10px; padding: 14px;">
        <h3 style="margin: 0 0 8px;">Silver</h3>
        <ul style="margin: 0; padding-left: 18px;">
            <li><strong>Quick + Deep review</strong></li>
            <li>General Counsel lens only</li>
            <li>No precedent bank signals</li>
        </ul>
    </div>

    <div style="border: 1px solid #e5e5e5; border-radius: 10px; padding: 14px;">
        <h3 style="margin: 0 0 8px;">Gold</h3>
        <ul style="margin: 0; padding-left: 18px;">
            <li><strong>Quick + Deep review</strong></li>
            <li>All lenses (GC + Privacy + Commercial + Security)</li>
            <li><strong>Precedent bank signals enabled</strong></li>
        </ul>
    </div>
</div>



    <p class="note">
        Clicking a plan sends you to a secure activation endpoint (your Function App).
        Because the Function App uses Entra SSO, you may be prompted to sign in.
        The backend writes your plan to Azure Table Storage for your tenant, then redirects you back here.
    </p>

    <p class="note">
        <a id="resetLink" href="#">Reset subscription (demo)</a>
    </p>

    <script>
        const APP_ORIGIN = "contract-weakness-api-ezdzg5hzcjfpfpa2.uksouth-01.azurewebsites.net";

        function loginThenGo(pathAfterLogin) {
            // Uses App Service Easy Auth sign-in endpoint.
            // After login, user gets redirected to the path you specify.
            const loginUrl = `${APP_ORIGIN}/.auth/login/aad?post_login_redirect_uri=${encodeURIComponent(pathAfterLogin)}`;
            window.location.href = loginUrl;
        }

        function activate(plan) {
            loginThenGo(`/api/subscription/activate?plan=${encodeURIComponent(plan)}`);
        }

        // Update reset link to go through login too
        document.getElementById("resetLink").href =
            `${APP_ORIGIN}/.auth/login/aad?post_login_redirect_uri=${encodeURIComponent("/api/subscription/reset")}`;
    </script> 

</body>

</html>